# Geo messages test scenario
#
# Exercises geo-tagged public posts in simulation by assigning each cohort
# a location profile. Public messages are generated with geo metadata and can
# be queried with GeoMessageRequest / GeoMeshAvailable flows.
#
# Example:
#   cargo run --bin tenet-sim -- scenarios/geo_messages_test.toml

[simulation]
node_ids = ["sf-1", "sf-2", "sf-3", "ldn-1", "ldn-2", "ldn-3"]
steps = 30
seed = 20260301

[simulation.simulated_time]
seconds_per_step = 300
default_speed_factor = 1.0

[simulation.friends_per_node]
type = "uniform"
min = 2
max = 4

[simulation.post_frequency]
type = "poisson"
lambda_per_hour = 5.0

# Default message mix for cohorts that don't override.
[simulation.message_type_weights]
direct = 0.2
public = 0.8
group = 0.0

[[simulation.cohorts]]
name = "sf_locals"
type = "always_online"
share = 0.5
[simulation.cohorts.message_type_weights]
direct = 0.15
public = 0.85
group = 0.0
[simulation.cohorts.geo]
country_code = "US"
region = "California"
city = "San Francisco"
geohash = "9q8yy"
lat = 37.7749
lon = -122.4194
post_precision = "neighborhood"
query_precision = "city"

[[simulation.cohorts]]
name = "london_locals"
type = "rarely_online"
share = 0.5
online_probability = 0.6
[simulation.cohorts.message_type_weights]
direct = 0.25
public = 0.75
group = 0.0
[simulation.cohorts.geo]
country_code = "GB"
region = "England"
city = "London"
geohash = "gcpvj"
lat = 51.5072
lon = -0.1276
post_precision = "city"
query_precision = "country"

# Per-node override to ensure node-specific geo config support is covered.
[simulation.node_geo_overrides."ldn-3"]
country_code = "GB"
region = "England"
city = "London"
geohash = "gcpvj0"
lat = 51.5090
lon = -0.1180
post_precision = "exact"
query_precision = "neighborhood"

[simulation.message_size_distribution]
type = "uniform"
min = 20
max = 120

[simulation.encryption]
type = "plaintext"

[simulation.reaction_config]
reply_probability = 0.2

[simulation.reaction_config.reply_delay_distribution]
type = "uniform"
min = 60.0
max = 300.0

[relay]
ttl_seconds = 3600
max_messages = 1000
max_bytes = 2097152
retry_backoff_seconds = [1, 2, 4]
peer_log_window_seconds = 30
peer_log_interval_seconds = 10
