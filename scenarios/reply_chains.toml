# Reply-chains scenario
#
# A focused test for the reaction_config feature.  Two cohorts (quick responders
# and slow responders) exchange messages across a dense 8-peer network with a
# high reply probability so that multi-round conversations develop naturally.
#
# Expected behaviour:
#   - sent_messages is substantially higher than planned_messages because most
#     received messages trigger a reply.
#   - Conversations cascade: A sends to B, B replies to A, A replies back, etc.,
#     until TTL expires or the simulation ends.
#   - The "slow-responders" cohort (rarely online) accumulates queued messages
#     during offline periods and bursts replies on reconnect.
#
# Vary reply_probability to tune conversation density:
#   0.1  – sparse, occasional back-and-forth
#   0.5  – active threads (this default)
#   1.0  – every message gets a reply; exponential cascades

[simulation]
node_ids = ["alice", "bob", "carol", "dave", "erin", "frank", "grace", "heidi"]
steps = 0
duration_seconds = 43200   # 12-hour window
seed = 11

[simulation.simulated_time]
seconds_per_step = 120
default_speed_factor = 1.0

[simulation.friends_per_node]
type = "uniform"
min = 3
max = 5

[simulation.post_frequency]
type = "poisson"
lambda_per_hour = 4.0

# Quick responders: always online, reply within 2–15 minutes
[[simulation.cohorts]]
name = "quick-responders"
type = "always_online"
share = 0.5

# Slow responders: dip offline, reply within 30 minutes to 2 hours when back
[[simulation.cohorts]]
name = "slow-responders"
type = "rarely_online"
share = 0.5
online_probability = 0.45

[simulation.message_size_distribution]
type = "normal"
mean = 80.0
std_dev = 30.0
min = 20
max = 300

[simulation.encryption]
type = "encrypted"

# ---------- Reply configuration ----------
# 50 % of received messages trigger a same-kind reply.
# Delay is log-normal centred around ~8 minutes (realistic human response time).
[simulation.reaction_config]
reply_probability = 0.5

[simulation.reaction_config.reply_delay_distribution]
type = "log_normal"
mean = 6.5    # ln(seconds) ≈ 8 minutes median
std_dev = 0.8

[relay]
ttl_seconds = 7200
max_messages = 1000
max_bytes = 2097152
retry_backoff_seconds = [1, 2, 4]
peer_log_window_seconds = 60
peer_log_interval_seconds = 20
