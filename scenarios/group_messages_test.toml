# Test scenario for group messages
# This scenario tests group message functionality with nodes organized into groups.

[simulation]
node_ids = ["peer-1", "peer-2", "peer-3", "peer-4", "peer-5", "peer-6", "peer-7", "peer-8"]
steps = 40
seed = 456

[simulation.simulated_time]
seconds_per_step = 300
default_speed_factor = 1.0

[simulation.friends_per_node]
type = "uniform"
min = 3
max = 5

[simulation.post_frequency]
type = "poisson"
lambda_per_hour = 6.0

# Default message type weights - mixed messaging
[simulation.message_type_weights]
direct = 0.4
public = 0.2
group = 0.4

# Group configuration
[simulation.groups]
count = 3

[simulation.groups.size_distribution]
type = "uniform"
min = 3
max = 5

[simulation.groups.memberships_per_node]
type = "uniform"
min = 1
max = 2

# Cohort that focuses on group messaging
[[simulation.cohorts]]
name = "group-chatters"
type = "always_online"
share = 0.4
[simulation.cohorts.message_type_weights]
direct = 0.2
public = 0.1
group = 0.7

# Cohort that uses a mix of all message types
[[simulation.cohorts]]
name = "mixed-users"
type = "diurnal"
share = 0.4
online_probability = 0.7
timezone_offset_hours = 0
hourly_weights = [0.2, 0.15, 0.1, 0.1, 0.15, 0.3, 0.5, 0.7, 0.9, 1.0, 1.0, 0.95, 0.9, 0.8, 0.75, 0.8, 0.9, 1.0, 0.95, 0.8, 0.6, 0.45, 0.3, 0.25]
[simulation.cohorts.message_type_weights]
direct = 0.5
public = 0.2
group = 0.3

# Cohort that primarily uses direct messages
[[simulation.cohorts]]
name = "private-messengers"
type = "rarely_online"
share = 0.2
online_probability = 0.3
[simulation.cohorts.message_type_weights]
direct = 0.9
public = 0.05
group = 0.05

[simulation.message_size_distribution]
type = "uniform"
min = 30
max = 150

[simulation.encryption]
type = "encrypted"

# 30 % of received messages trigger a same-kind reply (group replies stay in the
# same group, direct replies go back to the original sender).
[simulation.reaction_config]
reply_probability = 0.3

[simulation.reaction_config.reply_delay_distribution]
type = "log_normal"
mean = 6.0    # ln(seconds) â‰ˆ 6.5 minute median
std_dev = 0.7

[relay]
ttl_seconds = 2400
max_messages = 1000
max_bytes = 2097152
retry_backoff_seconds = [1, 2, 4]
peer_log_window_seconds = 30
peer_log_interval_seconds = 10
